# 图论

## 图

### 定义

> A graph $G = (V,E)$ consists of $V$, a *nonempty set* of vertices (or nodes) and $E$, a set of edges. Each edge has either one or two vertices associated with it, called its *endpoints*. An edge is said to *connect* its endpoints.

这是经常见到的一种定义。

> 图$G$是一个三元组$\langle V(G),E(G),\varphi_G\rangle$，其中$V(G)$是一个非空的节点集合，$E(G)$是边的集合，$\varphi_G$是从边集$E(G)$到节点无序偶（有序偶）关系上的函数。

这种定义更便于我们对图进行分类，以及进行类的设计。

### 分类

| Type                  | Edges                   | Multiple Edges Allowed? | Loops Allowed? |
| :-------------------- | ----------------------- | ----------------------- | -------------- |
| Simple graph          | Undirected              | N                       | N              |
| Multigraph            | Undirected              | Y                       | N              |
| Pseudograph           | Undirected              | Y                       | Y              |
| Simple directed graph | Directed                | N                       | N              |
| Directed multigraph   | Directed                | Y                       | Y              |
| Mixed graph           | Directed and undirected | Y                       | Y              |

可见，对应上述的第二个定义，边的有向与否对应关系有无序偶，多重边的有无对应$\varphi_G$是否为单射，环的有无对应关系有无自反性。

- 注：对于环，讨论其方向是无意义的，因此环总是无向的，起点和终点也是相同的。

### 一些特殊的图

- 零图：仅有孤立的节点构成的图，当仅由一个孤立节点构成时，称为平凡图。
- 完全图$K_n(n>0)$：要求任意一对顶点之间都存在边使二者相连，边数为$\frac{n(n-1)}{2}$。
- 圈图$C_n(n>2)$：要求各点顺次连接形成一个圈，且不存在其他的边。
- 轮图$W_n(n>3)$：将圈图$C_m$中添加一个节点，再与其他所有节点相连，所得到的新图就是轮图。

### 一些术语

- 邻接：对于点来说，一对节点由至少一条边相关联，则被称作邻接点；对于边来说，两条边关联于同一节点，则被称作邻接边。
- 度：对于一个节点$v$来说，与$v$相关联的边的条数称作该点的度，记作$deg(v)$。此外，对于有向图，以$v$为终点的边的条数称作该点的入度，记作$deg^-(v)$，以$v$为起点的边的条数称作该点的出度，记作$deg^+(v)$。此外，我们记$\delta(G)=\min\{deg(v)\big|v\in V(G)\}$，$\Delta(G)=\max\{deg(v)\big|v\in V(G)\}$分别是图$G$的最小度和最大度。
- 平行边：连接同一对节点的边。

### 有关度的几个定理

1. 任意一个图中，所有节点的度的总和等于边数的二倍。（握手定理）
2. 任意一个图中，度为奇数的节点个数必为偶数。（反证法）
3. 任意有向图中，所有节点的出度的总和等于入度的总和。

以上定理都是显然的，此处略去。

### 关系

- 子图与生成子图：设$G'=\langle V',E'\rangle$，$G=\langle V,E\rangle$满足$V'\subseteq V$且$E'\subseteq E$，则称$G'$是$G$的子图。若$G'$含有$G$的所有节点，则称$G'$是$G$的生成子图。
- 分图：设$H$是图$G$的子图，如果图$H$是连通的，且对于图$G$的任意子图$G'$，若$G'\ne H$，且$H\sube G'\sube G$，则$G'$不是连通图，则称$H$是$G$的分图。
- 补图：给定一个图$G$，由$G$中所有节点和所有能使$G$成为完全图的添加边组成的图称为$G$相对于完全图的补图，记作$\overline G$。若$G'=\langle V',E'\rangle$是$G =\langle V,E\rangle$，那么定义图$G''=\lang V'',E''\rang$满足$E''=E-E'$，而$V''$中仅包含$E'' $的边所关联的节点，则称图$G'' $是子图$G' $的相对于图$G$的补图。
- 同构：设图$G =\langle V , E \rangle$和$G'=\langle V',E'\rangle$，如果存在双射$g:v_i\rightarrow v'_i$，且对于边$\theta=(v_i,v_j)$（或$\lang v_i,v_j \rang$）是$G$的一条边，当且仅当$\theta'=(g(v_i),g(v_j))$（或$\lang g(v_i),g(v_j) \rang$）是$G'$的一条边，则称$G$与$G'$同构。如果两个图$G_1$和$G_2$是同构的，或者通过反复插入或删除度为$2$的结点，它们能变成同构的图，则称$G_1$和$G_2$在度为$2$的结点内同构。


## 路与回路

### 定义

给定图$G=\lang V,E\rang$，设$v_0,v_1,\dots,v_n\in V$，$e_1,e_2,\dots,e_n\in E$，其中$e_i$是关联于节点$v_{i-1},v_i$的边，交替序列$v_0e_1v_1e_2v_2\cdots e_nv_n$称为联结$v_0$到$v_n$的**路**。若一条路中所有边均不相同，则被称作**迹**。若一条路中所有节点均不相同，则被称作**通路**。如果$v_0=v_n$，则这条路称作**回路**。同时是通路和回路的路称作**圈**。（这里只允许$v_0=v_n$）

无向图$G$中，节点$u,v$之间如果存在一条路，则称$u,v$是**连通**的。若一个图$G$有且只有一个连通分支，则称该图是连通图。

设无向图$G=\lang V,E\rang $为连通图，若有点集$V_1\sub V$，使得图$G$删除了$V_1$中的所有节点后，所得的子图不是连通图，但删除$V_1$的任意真子集后，所得到的子图仍然是连通图，则称$V_1$是$G$的一个**点割集**。若某一个节点独自构成一个点割集，则称该节点为割点。

设无向图$G=\lang V,E\rang $为连通图，若有点集$E_1\sub E$，使得图$G$删除了$E_1$中的所有边后，所得的子图不是连通图，但删除$E _1$的任意真子集后，所得到的子图仍然是连通图，则称$ E_1$是$G$的一个**边割集**。若某一边独自构成一个边割集，则称该节点为割边（桥）。

我们定义$k(G)=\min\{ |V_1|\big| V_1是G的点割集 \}$为$G$的**点连通度**，$\lambda (G)=\min\{ |E_1|\big|E_1是G的边割集 \}$为$G$的**边连通度**。

对于有向图来说以上无向图的连通性不能够直接推广，应为在有向图中，节点间存在路，称为节点的**可达性**。类比于连通的定义，我们有，有向图$G$中，节点$u$到$v$如果存在一条路，则称$u$是**可达**$v$的。

可达性是一种建立在有向图节点集上的二元关系，它是自反和传递的，但一般来说是不对称的，因此可达性不是等价关系。

如果$u$可达$v$，则他们之间可能存在不止一条路，在这些路中最短路的长度称为节点$u$和$v$之间的距离，记作$d\lang u,v\rang$。这里需要注意，距离的定义是可以适用于无向图的。另外，我们记$D=\max \ d\lang u,v\rang$称作图的**直径**。

接着是放宽条件的一些推广。在简单有向图$G$中，任何一对节点间，至少有一个节点到另一个节点是可达的，则称这个图是**单侧连通**的。如果对于$G$中任何一对节点两者之间是可达的，则称这个图是**强连通**的。如果在$G$中略去边的方向，将它看成无向图，同时图是连通的，则称该图是**弱连通**的。

在简单有向图中，具有强连通性质的最大子图称为强分图；具有单侧连通性质的最大子图，称为单侧分图；具有弱连通性质的最大子图，称为弱分图。

### 一些定理

- 在一个具有$n$个结点的图中，如果从节点$v_j$到节点$v_k$间存在一条通路，那么从节点$v_j$到节点$v_k$间必定存在一条不多于$n-1$条边的路。（反证法）

- 对于任何一个图$G$，有如下不等式成立：

  $$
  k(G)\le\lambda(G)\le \delta(G)
  $$
  
- 一个连通无向图$G$中的节点$v$是割点的充要条件是存在两个节点$u,w$使得节点$u,w$之间的每一条路都通过$v$。

- 关于距离的性质

  $$
  \begin{array} { l } { d \langle u , v \rangle \geqslant 0 } \\ { d \langle u , w \rangle = 0 }\\
  d \langle u , v \rangle + d \langle v , w \rangle \geqslant d \langle u , w \rangle
  \end{array}
  $$

- 一个有向图是强连通的，当且仅当$G$中只含有一个回路，它至少包含每个节点一次。
- 在一个有向图中，它的每一个节点都位于且仅为于一个强分图中。
- 图的每一个节点和每一条边，都只包含于一个弱分图中。

## 图的表示

- 图解表示法

- 邻接矩阵

  - 设图$G=\lang V,E\rang$，其中$V=\{v_1,v_2,\ldots,v_n\}$，$n$阶方阵$A=[a_{ij}]$满足
    $$
    a_{ij}=\begin{cases}
    1,&e_{ij}=(v_i,v_j)\in E\\
    0,&e_{ij}=(v_i,v_j)\notin E
    \end{cases}
    $$
    则称$A$是图$G$的邻接矩阵。

  - 矩阵$A^l$的第$i$行第$j$列的元素$a_{ij}$表示图$G$中连接$v_i$和$v_j$长度为$l$的路径的数目。

- 连接矩阵

  - 设图$G=\lang V,E\rang$，其中$V=\{v_1,v_2,\ldots,v_n\}$，$n$阶方阵$C=[c_{ij}]$满足
    $$
    c_{ij}=\begin{cases}
    1,&存在连接v_i和v_j的通路\\
    0,&不存在连接v_i和v_j的通路
    \end{cases}
    $$

  - 可由邻接矩阵计算得到连接矩阵。

- 邻接表

- 可达矩阵

## 二分图（二部图）

若把简单图$G$的顶点集分成两个不相交的非空集合$V_1,V_2$，使得图中的每一条边都连接$V_1$中的一个顶点与$V_2$中的一个顶点，则$G$称为二分图，并称$(V_1,V_2)$是$G$的顶点集的一个二部划分。

完全二分图（记作$K_{m,n}$）是顶点集划分为分别含有$m,n$个顶点的两个子集的图，并且两个顶点之间有边当且仅当一个顶点属于第一个子集二另一个顶点属于第二个子集。



一个简单图是二分图的充分必要条件是能够对图中的每个顶点赋予两种不同的颜色，并使得没有两个相邻的顶点被赋予相同的颜色。

图$G$为二部图的充要条件是$G$的所有回路均为偶数长。 

一个匹配$M$指简单图$G$的边集$E$的子集满足该集合中任意两条边关联的顶点不相同。包含最多边数的一个匹配被称为最大匹配。

若在二分图$G$中的一个匹配$M$，其划分为$(V_1,V_2)$，若$V_1$中的每一个顶点都是匹配中的边的端点，或$|M|=|V_1|$，则称匹配$M$时从$V_1$到$V_2$的完全匹配。

霍尔婚姻定理

- 带有二部划分$(V_1,V_2)$的二分图$G$中有从$V_1$到$V_2$的完全匹配当且仅当对于$V_1$的所有子集$A$，有$|N(A)|\ge |A|$。

## 欧拉图与哈密顿图
欧拉通路: 通过图中每条边且只通过一次，并且经过每一顶点的通路

欧拉回路: 通过图中每条边且只通过一次，并且经过每一顶点的回路

有向图的基图：忽略有向图所有边的方向，得到的无向图称为该有向图的基图。 

- 无向图

  设$G$是连通无向图，则称经过$G$的每条边一次并且仅一次的路径为欧拉通路；如果欧拉通路是回路（起点和终点是同一个顶点），则称此回路是欧拉回路具有欧拉回路的无向图$G$成为欧拉图

- 有向图

  设$D$是有向图，$D$的基图连通，则称经过$D$的每条边一次并且仅有一次的有向路径为有向欧拉通路。如果有向欧拉通路是有向回路，则称此有向回路为有向欧拉回路。具有有向欧拉回路的图$D$称为有向欧拉图。

- 定理

  无向图$G$存在欧拉通路的充要条件是：$G$为连通图，并且$G$仅有两个奇度结点（度数为奇数的顶点）或者无奇度结点。

  有向图$D$存在欧拉通路的充要条件是：$D$为有向图，$D$的基图连通，并且所有顶点的出度与入度相等；或者除两个顶点外，其余顶点的出度与入度都相等，而这两个顶点中一个顶点的出度与入度之差为$1$，另一个顶点的出度与入度之差为$-1$。

- 注：

  （1）当$G$是仅有两个奇度结点的连通图时，$G$的欧拉通路必以此两个结点为端点。

  （2）当$G$是无奇度结点的连通图时，$G$必有欧拉回路。

  （3）$G$为欧拉图（存在欧拉回路）的充分必要条件是$G$为无奇度结点的连通图。

  （1）当$D$除出、入度之差为$1$，$-1$的两个顶点之外，其余顶点的出度与入度相等时，$D$的有向欧拉通路必以出、入度之差为$1$的顶点作为始点，以出、入度之差为$-1$的顶点作为终点。

  （2）当$D$的所有顶点的出、入度都相等时，$D$中存在有向欧拉回路。

  （3）有向图$D$为有向欧拉图的充要条件是$D$的基图为连通图，并且所有顶点的出、入度都相等。

哈密顿通路：设$G$为一图（无向图或有向图）。$G$中经过每个顶点一次且仅一次的通路称作哈密顿通路。

哈密顿回路：$G$中经过每个顶点一次且仅一次的回路（通路基础上并回到起始点）称作哈密顿回路。

哈密顿图：若$G$中存在哈密顿回路，则称它是哈密顿图。

（1）存在哈密顿通路（回路）的图一定是连通图。

（2）哈密顿通路是初级通路，哈密顿回路是初级回路。

（3）若$G$中存在哈密顿回路，则它一定存在哈密顿通路，反之不真。

- 狄拉克定理
  - 如果图$G$是有$n$个顶点的简单图，且$n\ge 3$，并且$G$中每个顶点的度都至少是$n/2$，则$G$有哈密顿回路
- 欧尔定理
  - 如果图$G$是有$n$个顶点的简单图，且$n\ge 3$，并且对于$G$中的每一对不相邻的顶点$u,v$来说都有$deg(u)+deg(v)\ge n$，则$G$有哈密顿回路。

## 最短通路问题

### Dijkstra算法

算法描述

- 算法思想：设$G=\lang V,E\rang$是一个带权有向图，把图中顶点集合$V$分成两组，第一组为已求出最短路径的顶点集合（用$S$表示，初始时$S$中只有一个源点，以后每求得一条最短路径 , 就将加入到集合$S$中，直到全部顶点都加入到$S$中，算法就结束了），第二组为其余未确定最短路径的顶点集合（用$U$表示），按最短路径长度的递增次序依次把第二组的顶点加入$S$中。在加入的过程中，总保持从源点$v$到$S$中各顶点的最短路径长度不大于从源点$v$到$U$中任何顶点的最短路径长度。此外，每个顶点对应一个距离，$S$中的顶点的距离就是从$v$到此顶点的最短路径长度，$U$中的顶点的距离，是从$v$到此顶点只包括$S$中的顶点为中间顶点的当前最短路径长度。

- 算法步骤：

1. 初始时，$S$只包含源点，即$S＝\{v\}$，$v$的距离为$0$。$U$包含除$v$外的其他顶点，即$U=\{其余顶点\}$，若$v$与$U$中顶点$u$有边，则$<u,v>$正常有权值，若$u$不是$v$的出边邻接点，则$<u,v>$权值为$\infin$。
2. 从$U$中选取一个距离$v$最小的顶点$k$，把$k$，加入$S$中（该选定的距离就是$v$到$k$的最短路径长度）。
3. 以$k$为新考虑的中间点，修改$U$中各顶点的距离；若从源点$v$到顶点$u$的距离（经过顶点$k$）比原来距离（不经过顶点$k$）短，则修改顶点$u$的距离值，修改后的距离值的顶点$k$的距离加上边上的权。
4. 重复步骤$b$和$c$直到所有顶点都包含在$S$中。

## 图着色

- 平面图：若可以在平面中画出一个图而边没有任何交叉，则这个图被称为平面图。
- 设$G$是一个连通平面图，$G$的边将$G$所在的平面划分成若干个区域，每一个区域称为$G$的一个面。其中面积无限的区域称为无限面。面积有限的区域称为有限面。包围每个面的所有边构成的回路称为面的边界。
- 设$G$是连通平面图，有$n$个结点，$m$条边，$K$个面，则$n–m+K=2$。此定理中的公式称为欧拉公式。
- 设$G$是$（n，m）$的连通平面图，$m\ge 2$，则$m\le 3n–6$。

- 四色定理：平面图的着色数不超过4

- 一个图是平面图的充要条件是它不包含在度为$2$的结点内与$K_5$同构的子图，也不包含在度为$2$的结点内与$K_{3,3}$同构的子图。因为$K_5$和$K_{3,3}$都不是平面图。


## Graph类

### 图的存储方式

- 邻接表
- 邻接矩阵

### 以顶点和边为中心的ADT

## 树

### 定义

不包含环的连通图称为树。

- 满二叉树：一个二叉树，如果每一个层的结点数都达到最大值，则这个二叉树就是满二叉树。也就是说，如果一个二叉树的层数为$k$，且结点总数是$2^k-1 $，则它就是满二叉树。
- 完全二叉树：对于一个树高为$h$的二叉树，如果其第$0$层至第$h-1$层的节点都满。如果最下面一层节点不满，则所有的节点在左边的连续排列，空位都在右边。这样的二叉树就是一棵完全二叉树。
- 正则二叉树：在根树中，若每个分支点的出度小于或等于$m$,则称该树为$m$叉树。如果每个分支点的出度恰好等于$m$，则称该树为$m$叉正则树。$m=2$时，该根树称为二叉正则树。若其所有树叶层次相同，称为二叉完全正则树。
- 平衡二叉树：每棵子树中的左子树和右子树的深度差不能超过 1；二叉树中每棵子树都要求是平衡二叉树；
- 内点：有孩子的节点。

### 性质

- 设$T$是一棵树，$v_i$和$v_j$是$T$中任意两个不同的结点，则$v_i$和$v_j$由唯一条真路相连接。若$v_i$和$v_j$不相邻接，那么当给$T$添加一条边$(v_i,v_j)$后形成的图恰有一个环。

- 边数与顶点数的关系$m=n-1$。

- 带有$i$个内点的满$m$叉树含有$n=mi+1$个顶点，$l=(m-1)i+1$个树叶。
- 

### 最小生成树

- 生成树

    - 若连通图$G$的生成子图$T$是一棵树，则称$T$为$G$的生成树。

- 最小生成树

    设$G$是一连通带权图,各边权值为$w(e)$，$T$是$G$的一棵生成树，$T$的边集用$E（T）$表示，$T$的各边权值之和$W（T）=\sum_{e\in E(T)}w(e)$称为$T$的权。$G$的所有生成树中权最小的生成树称为$G$的最小生成树。
    
- Prim算法

    1. 初始化图$G\lang V,E\rang$，以及各边权值$\{W_1,W_2,W_3,\ldots,W_i,\ldots,W_m\}$，集合$T$是由每轮循环所挑选出的边构成的集合，初始化时仅含$E$中权值最小的边。
    2. 挑选出$E$中与$T$中相关联的且添加进$T$中不形成简单回路的权值最小的边加入集合$T$。
    3. 循环$n-2$次。

- Kruskal算法

    1. 初始化图$G\lang V,E\rang$，以及各边权值$\{W_1,W_2,W_3,\ldots,W_i,\ldots,W_m\}$，集合$T$是由每轮循环所挑选出的边构成的集合，初始化时为空集。
    2. 挑选出$E$中权值最小的任一边且当添加到$T$中不形成简单回路的边。
    3. 循环$n-1$次。

### 遍历

- 前序
- 中序
- 后序

### 前缀码

为了保证没有位串对应着多个字母的序列，可以令一个字母的位串永远不出现在另一个字母的位串的开头部分。具有这样性质的编码叫做前缀码。

例如，$\{0,10,110\}$就是一个前缀码，而$\{0,10,101\}$就不是前缀码。

- 哈夫曼编码

    1. 对给定的$n$个权值$\{W_1,W_2,W_3,\ldots,W_i,\ldots,W_n\}$构成$n$棵二叉树的初始集合$F=\{T_1,T_2,T_3,\ldots,T_i,\ldots,T_n\}$，其中每棵二叉树$T_i$中只有一个权值为$W_i$的根结点，它的左右子树均为空。（为方便在计算机上实现算法，一般还要求以$T_i$的权值$W_i$的升序排列。）
   2. 在$F$中选取两棵根结点权值最小的树作为新构造的二叉树的左右子树，新二叉树的根结点的权值为其左右子树的根结点的权值之和。
   2. 从$F$中删除这两棵树，并把这棵新的二叉树同样以升序排列加入到集合$F$中。
   3. 重复2和3两步，直到集合$F$中只有一棵二叉树为止。
